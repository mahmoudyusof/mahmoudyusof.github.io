<!DOCTYPE html>
<html data-html-server-rendered="true" lang="en" data-vue-tag="%7B%22lang%22:%7B%22ssr%22:%22en%22%7D%7D">
  <head>
    <title>A Comprehensive Guide For scikit-learn Pipelines</title><meta name="gridsome:hash" content="5b5f75d25e19532c39ff18cd701a577df7c533a1"><meta data-vue-tag="ssr" charset="utf-8"><meta data-vue-tag="ssr" name="generator" content="Gridsome v0.7.23"><meta data-vue-tag="ssr" data-key="viewport" name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"><meta data-vue-tag="ssr" data-key="format-detection" name="format-detection" content="telephone=no"><meta data-vue-tag="ssr" property="og:type" content="article"><meta data-vue-tag="ssr" property="og:title" content="A Comprehensive Guide For scikit-learn Pipelines"><meta data-vue-tag="ssr" property="og:image" content="https://mahmoudyusof.github.io/seo_images/sklearn-pipelines.jpg"><meta data-vue-tag="ssr" property="og:description" content="Going through a step by step guide for building machine learning pipelines for data preprocessing and inference, also covering how preprocess different columns with different transformers, how to add custom transformers, and how to save and load complete pipelines"><meta data-vue-tag="ssr" property="og:url" content="https://mahmoudyusof.github.io/general/scikit-learn-pipelines/"><link data-vue-tag="ssr" rel="icon" href="data:,"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="16x16" href="/assets/static/favicon.ce0531f.24997f41124815fbd54f8ef1117b7c92.png"><link data-vue-tag="ssr" rel="icon" type="image/png" sizes="32x32" href="/assets/static/favicon.ac8d93a.24997f41124815fbd54f8ef1117b7c92.png"><link data-vue-tag="ssr" rel="apple-touch-icon" type="image/png" sizes="76x76" href="/assets/static/favicon.f22e9f3.24997f41124815fbd54f8ef1117b7c92.png"><link data-vue-tag="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Nunito:wght@200;300;400&amp;display=swap"><link data-vue-tag="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@100;300;400;500;700&amp;display=swap"><link data-vue-tag="ssr" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Material+Icons"><link rel="preload" href="/assets/css/0.styles.c4bea370.css" as="style"><link rel="preload" href="/assets/js/app.640e4b72.js" as="script"><link rel="preload" href="/assets/js/page--src--templates--article-vue.e8a69820.js" as="script"><link rel="prefetch" href="/assets/js/page--src--pages--404-vue.ef18b5d0.js"><link rel="prefetch" href="/assets/js/page--src--pages--index-vue.8ae0bfae.js"><link rel="prefetch" href="/assets/js/page--src--pages--projects--digit-image-generator--index-vue.f2ad3337.js"><link rel="prefetch" href="/assets/js/page--src--pages--projects--sorting-visualizer--index-vue.b8c458fa.js"><link rel="prefetch" href="/assets/js/vendors~page--src--pages--projects--digit-image-generator--index-vue.604604e6.js"><link rel="stylesheet" href="/assets/css/0.styles.c4bea370.css"><style data-vue-tag="vuetify" type="text/css" id="vuetify-theme-stylesheet" nonce="undefined">:root {
  --v-anchor-base: #263238;
  --v-primary-base: #263238;
  --v-primary-lighten5: #9fadb5;
  --v-primary-lighten4: #85939a;
  --v-primary-lighten3: #6c7980;
  --v-primary-lighten2: #536067;
  --v-primary-lighten1: #3c484f;
  --v-primary-darken1: #111d23;
  --v-primary-darken2: #00030d;
  --v-primary-darken3: #000000;
  --v-primary-darken4: #000000;
  --v-secondary-base: #37474f;
  --v-secondary-lighten5: #b5c7d0;
  --v-secondary-lighten4: #9aacb5;
  --v-secondary-lighten3: #80919a;
  --v-secondary-lighten2: #677780;
  --v-secondary-lighten1: #4e5f67;
  --v-secondary-darken1: #213138;
  --v-secondary-darken2: #0c1c23;
  --v-secondary-darken3: #00010d;
  --v-secondary-darken4: #000000;
  --v-accent-base: #57676f;
  --v-accent-lighten5: #dbedf6;
  --v-accent-lighten4: #bfd0d9;
  --v-accent-lighten3: #a4b5be;
  --v-accent-lighten2: #899aa3;
  --v-accent-lighten1: #708088;
  --v-accent-darken1: #3f4f57;
  --v-accent-darken2: #29383f;
  --v-accent-darken3: #142329;
  --v-accent-darken4: #000d15;
  --v-error-base: #ff5252;
  --v-error-lighten5: #ffe4d5;
  --v-error-lighten4: #ffc6b9;
  --v-error-lighten3: #ffa99e;
  --v-error-lighten2: #ff8c84;
  --v-error-lighten1: #ff6f6a;
  --v-error-darken1: #df323b;
  --v-error-darken2: #bf0025;
  --v-error-darken3: #9f0010;
  --v-error-darken4: #800000;
  --v-info-base: #2196f3;
  --v-info-lighten5: #d4ffff;
  --v-info-lighten4: #b5ffff;
  --v-info-lighten3: #95e8ff;
  --v-info-lighten2: #75ccff;
  --v-info-lighten1: #51b0ff;
  --v-info-darken1: #007cd6;
  --v-info-darken2: #0064ba;
  --v-info-darken3: #004d9f;
  --v-info-darken4: #003784;
  --v-success-base: #4caf50;
  --v-success-lighten5: #dcffd6;
  --v-success-lighten4: #beffba;
  --v-success-lighten3: #a2ff9e;
  --v-success-lighten2: #85e783;
  --v-success-lighten1: #69cb69;
  --v-success-darken1: #2d9437;
  --v-success-darken2: #00791e;
  --v-success-darken3: #006000;
  --v-success-darken4: #004700;
  --v-warning-base: #fb8c00;
  --v-warning-lighten5: #ffff9e;
  --v-warning-lighten4: #fffb82;
  --v-warning-lighten3: #ffdf67;
  --v-warning-lighten2: #ffc24b;
  --v-warning-lighten1: #ffa72d;
  --v-warning-darken1: #db7200;
  --v-warning-darken2: #bb5900;
  --v-warning-darken3: #9d4000;
  --v-warning-darken4: #802700;
  --v-text-base: #ffffff;
  --v-text-lighten5: #ffffff;
  --v-text-lighten4: #ffffff;
  --v-text-lighten3: #ffffff;
  --v-text-lighten2: #ffffff;
  --v-text-lighten1: #ffffff;
  --v-text-darken1: #e2e2e2;
  --v-text-darken2: #c6c6c6;
  --v-text-darken3: #ababab;
  --v-text-darken4: #919191;
  --v-background-base: #263238;
  --v-background-lighten5: #9fadb5;
  --v-background-lighten4: #85939a;
  --v-background-lighten3: #6c7980;
  --v-background-lighten2: #536067;
  --v-background-lighten1: #3c484f;
  --v-background-darken1: #111d23;
  --v-background-darken2: #00030d;
  --v-background-darken3: #000000;
  --v-background-darken4: #000000;
}

.v-application a { color: var(--v-anchor-base); }
.v-application .primary {
  background-color: var(--v-primary-base) !important;
  border-color: var(--v-primary-base) !important;
}
.v-application .primary--text {
  color: var(--v-primary-base) !important;
  caret-color: var(--v-primary-base) !important;
}
.v-application .primary.lighten-5 {
  background-color: var(--v-primary-lighten5) !important;
  border-color: var(--v-primary-lighten5) !important;
}
.v-application .primary--text.text--lighten-5 {
  color: var(--v-primary-lighten5) !important;
  caret-color: var(--v-primary-lighten5) !important;
}
.v-application .primary.lighten-4 {
  background-color: var(--v-primary-lighten4) !important;
  border-color: var(--v-primary-lighten4) !important;
}
.v-application .primary--text.text--lighten-4 {
  color: var(--v-primary-lighten4) !important;
  caret-color: var(--v-primary-lighten4) !important;
}
.v-application .primary.lighten-3 {
  background-color: var(--v-primary-lighten3) !important;
  border-color: var(--v-primary-lighten3) !important;
}
.v-application .primary--text.text--lighten-3 {
  color: var(--v-primary-lighten3) !important;
  caret-color: var(--v-primary-lighten3) !important;
}
.v-application .primary.lighten-2 {
  background-color: var(--v-primary-lighten2) !important;
  border-color: var(--v-primary-lighten2) !important;
}
.v-application .primary--text.text--lighten-2 {
  color: var(--v-primary-lighten2) !important;
  caret-color: var(--v-primary-lighten2) !important;
}
.v-application .primary.lighten-1 {
  background-color: var(--v-primary-lighten1) !important;
  border-color: var(--v-primary-lighten1) !important;
}
.v-application .primary--text.text--lighten-1 {
  color: var(--v-primary-lighten1) !important;
  caret-color: var(--v-primary-lighten1) !important;
}
.v-application .primary.darken-1 {
  background-color: var(--v-primary-darken1) !important;
  border-color: var(--v-primary-darken1) !important;
}
.v-application .primary--text.text--darken-1 {
  color: var(--v-primary-darken1) !important;
  caret-color: var(--v-primary-darken1) !important;
}
.v-application .primary.darken-2 {
  background-color: var(--v-primary-darken2) !important;
  border-color: var(--v-primary-darken2) !important;
}
.v-application .primary--text.text--darken-2 {
  color: var(--v-primary-darken2) !important;
  caret-color: var(--v-primary-darken2) !important;
}
.v-application .primary.darken-3 {
  background-color: var(--v-primary-darken3) !important;
  border-color: var(--v-primary-darken3) !important;
}
.v-application .primary--text.text--darken-3 {
  color: var(--v-primary-darken3) !important;
  caret-color: var(--v-primary-darken3) !important;
}
.v-application .primary.darken-4 {
  background-color: var(--v-primary-darken4) !important;
  border-color: var(--v-primary-darken4) !important;
}
.v-application .primary--text.text--darken-4 {
  color: var(--v-primary-darken4) !important;
  caret-color: var(--v-primary-darken4) !important;
}
.v-application .secondary {
  background-color: var(--v-secondary-base) !important;
  border-color: var(--v-secondary-base) !important;
}
.v-application .secondary--text {
  color: var(--v-secondary-base) !important;
  caret-color: var(--v-secondary-base) !important;
}
.v-application .secondary.lighten-5 {
  background-color: var(--v-secondary-lighten5) !important;
  border-color: var(--v-secondary-lighten5) !important;
}
.v-application .secondary--text.text--lighten-5 {
  color: var(--v-secondary-lighten5) !important;
  caret-color: var(--v-secondary-lighten5) !important;
}
.v-application .secondary.lighten-4 {
  background-color: var(--v-secondary-lighten4) !important;
  border-color: var(--v-secondary-lighten4) !important;
}
.v-application .secondary--text.text--lighten-4 {
  color: var(--v-secondary-lighten4) !important;
  caret-color: var(--v-secondary-lighten4) !important;
}
.v-application .secondary.lighten-3 {
  background-color: var(--v-secondary-lighten3) !important;
  border-color: var(--v-secondary-lighten3) !important;
}
.v-application .secondary--text.text--lighten-3 {
  color: var(--v-secondary-lighten3) !important;
  caret-color: var(--v-secondary-lighten3) !important;
}
.v-application .secondary.lighten-2 {
  background-color: var(--v-secondary-lighten2) !important;
  border-color: var(--v-secondary-lighten2) !important;
}
.v-application .secondary--text.text--lighten-2 {
  color: var(--v-secondary-lighten2) !important;
  caret-color: var(--v-secondary-lighten2) !important;
}
.v-application .secondary.lighten-1 {
  background-color: var(--v-secondary-lighten1) !important;
  border-color: var(--v-secondary-lighten1) !important;
}
.v-application .secondary--text.text--lighten-1 {
  color: var(--v-secondary-lighten1) !important;
  caret-color: var(--v-secondary-lighten1) !important;
}
.v-application .secondary.darken-1 {
  background-color: var(--v-secondary-darken1) !important;
  border-color: var(--v-secondary-darken1) !important;
}
.v-application .secondary--text.text--darken-1 {
  color: var(--v-secondary-darken1) !important;
  caret-color: var(--v-secondary-darken1) !important;
}
.v-application .secondary.darken-2 {
  background-color: var(--v-secondary-darken2) !important;
  border-color: var(--v-secondary-darken2) !important;
}
.v-application .secondary--text.text--darken-2 {
  color: var(--v-secondary-darken2) !important;
  caret-color: var(--v-secondary-darken2) !important;
}
.v-application .secondary.darken-3 {
  background-color: var(--v-secondary-darken3) !important;
  border-color: var(--v-secondary-darken3) !important;
}
.v-application .secondary--text.text--darken-3 {
  color: var(--v-secondary-darken3) !important;
  caret-color: var(--v-secondary-darken3) !important;
}
.v-application .secondary.darken-4 {
  background-color: var(--v-secondary-darken4) !important;
  border-color: var(--v-secondary-darken4) !important;
}
.v-application .secondary--text.text--darken-4 {
  color: var(--v-secondary-darken4) !important;
  caret-color: var(--v-secondary-darken4) !important;
}
.v-application .accent {
  background-color: var(--v-accent-base) !important;
  border-color: var(--v-accent-base) !important;
}
.v-application .accent--text {
  color: var(--v-accent-base) !important;
  caret-color: var(--v-accent-base) !important;
}
.v-application .accent.lighten-5 {
  background-color: var(--v-accent-lighten5) !important;
  border-color: var(--v-accent-lighten5) !important;
}
.v-application .accent--text.text--lighten-5 {
  color: var(--v-accent-lighten5) !important;
  caret-color: var(--v-accent-lighten5) !important;
}
.v-application .accent.lighten-4 {
  background-color: var(--v-accent-lighten4) !important;
  border-color: var(--v-accent-lighten4) !important;
}
.v-application .accent--text.text--lighten-4 {
  color: var(--v-accent-lighten4) !important;
  caret-color: var(--v-accent-lighten4) !important;
}
.v-application .accent.lighten-3 {
  background-color: var(--v-accent-lighten3) !important;
  border-color: var(--v-accent-lighten3) !important;
}
.v-application .accent--text.text--lighten-3 {
  color: var(--v-accent-lighten3) !important;
  caret-color: var(--v-accent-lighten3) !important;
}
.v-application .accent.lighten-2 {
  background-color: var(--v-accent-lighten2) !important;
  border-color: var(--v-accent-lighten2) !important;
}
.v-application .accent--text.text--lighten-2 {
  color: var(--v-accent-lighten2) !important;
  caret-color: var(--v-accent-lighten2) !important;
}
.v-application .accent.lighten-1 {
  background-color: var(--v-accent-lighten1) !important;
  border-color: var(--v-accent-lighten1) !important;
}
.v-application .accent--text.text--lighten-1 {
  color: var(--v-accent-lighten1) !important;
  caret-color: var(--v-accent-lighten1) !important;
}
.v-application .accent.darken-1 {
  background-color: var(--v-accent-darken1) !important;
  border-color: var(--v-accent-darken1) !important;
}
.v-application .accent--text.text--darken-1 {
  color: var(--v-accent-darken1) !important;
  caret-color: var(--v-accent-darken1) !important;
}
.v-application .accent.darken-2 {
  background-color: var(--v-accent-darken2) !important;
  border-color: var(--v-accent-darken2) !important;
}
.v-application .accent--text.text--darken-2 {
  color: var(--v-accent-darken2) !important;
  caret-color: var(--v-accent-darken2) !important;
}
.v-application .accent.darken-3 {
  background-color: var(--v-accent-darken3) !important;
  border-color: var(--v-accent-darken3) !important;
}
.v-application .accent--text.text--darken-3 {
  color: var(--v-accent-darken3) !important;
  caret-color: var(--v-accent-darken3) !important;
}
.v-application .accent.darken-4 {
  background-color: var(--v-accent-darken4) !important;
  border-color: var(--v-accent-darken4) !important;
}
.v-application .accent--text.text--darken-4 {
  color: var(--v-accent-darken4) !important;
  caret-color: var(--v-accent-darken4) !important;
}
.v-application .error {
  background-color: var(--v-error-base) !important;
  border-color: var(--v-error-base) !important;
}
.v-application .error--text {
  color: var(--v-error-base) !important;
  caret-color: var(--v-error-base) !important;
}
.v-application .error.lighten-5 {
  background-color: var(--v-error-lighten5) !important;
  border-color: var(--v-error-lighten5) !important;
}
.v-application .error--text.text--lighten-5 {
  color: var(--v-error-lighten5) !important;
  caret-color: var(--v-error-lighten5) !important;
}
.v-application .error.lighten-4 {
  background-color: var(--v-error-lighten4) !important;
  border-color: var(--v-error-lighten4) !important;
}
.v-application .error--text.text--lighten-4 {
  color: var(--v-error-lighten4) !important;
  caret-color: var(--v-error-lighten4) !important;
}
.v-application .error.lighten-3 {
  background-color: var(--v-error-lighten3) !important;
  border-color: var(--v-error-lighten3) !important;
}
.v-application .error--text.text--lighten-3 {
  color: var(--v-error-lighten3) !important;
  caret-color: var(--v-error-lighten3) !important;
}
.v-application .error.lighten-2 {
  background-color: var(--v-error-lighten2) !important;
  border-color: var(--v-error-lighten2) !important;
}
.v-application .error--text.text--lighten-2 {
  color: var(--v-error-lighten2) !important;
  caret-color: var(--v-error-lighten2) !important;
}
.v-application .error.lighten-1 {
  background-color: var(--v-error-lighten1) !important;
  border-color: var(--v-error-lighten1) !important;
}
.v-application .error--text.text--lighten-1 {
  color: var(--v-error-lighten1) !important;
  caret-color: var(--v-error-lighten1) !important;
}
.v-application .error.darken-1 {
  background-color: var(--v-error-darken1) !important;
  border-color: var(--v-error-darken1) !important;
}
.v-application .error--text.text--darken-1 {
  color: var(--v-error-darken1) !important;
  caret-color: var(--v-error-darken1) !important;
}
.v-application .error.darken-2 {
  background-color: var(--v-error-darken2) !important;
  border-color: var(--v-error-darken2) !important;
}
.v-application .error--text.text--darken-2 {
  color: var(--v-error-darken2) !important;
  caret-color: var(--v-error-darken2) !important;
}
.v-application .error.darken-3 {
  background-color: var(--v-error-darken3) !important;
  border-color: var(--v-error-darken3) !important;
}
.v-application .error--text.text--darken-3 {
  color: var(--v-error-darken3) !important;
  caret-color: var(--v-error-darken3) !important;
}
.v-application .error.darken-4 {
  background-color: var(--v-error-darken4) !important;
  border-color: var(--v-error-darken4) !important;
}
.v-application .error--text.text--darken-4 {
  color: var(--v-error-darken4) !important;
  caret-color: var(--v-error-darken4) !important;
}
.v-application .info {
  background-color: var(--v-info-base) !important;
  border-color: var(--v-info-base) !important;
}
.v-application .info--text {
  color: var(--v-info-base) !important;
  caret-color: var(--v-info-base) !important;
}
.v-application .info.lighten-5 {
  background-color: var(--v-info-lighten5) !important;
  border-color: var(--v-info-lighten5) !important;
}
.v-application .info--text.text--lighten-5 {
  color: var(--v-info-lighten5) !important;
  caret-color: var(--v-info-lighten5) !important;
}
.v-application .info.lighten-4 {
  background-color: var(--v-info-lighten4) !important;
  border-color: var(--v-info-lighten4) !important;
}
.v-application .info--text.text--lighten-4 {
  color: var(--v-info-lighten4) !important;
  caret-color: var(--v-info-lighten4) !important;
}
.v-application .info.lighten-3 {
  background-color: var(--v-info-lighten3) !important;
  border-color: var(--v-info-lighten3) !important;
}
.v-application .info--text.text--lighten-3 {
  color: var(--v-info-lighten3) !important;
  caret-color: var(--v-info-lighten3) !important;
}
.v-application .info.lighten-2 {
  background-color: var(--v-info-lighten2) !important;
  border-color: var(--v-info-lighten2) !important;
}
.v-application .info--text.text--lighten-2 {
  color: var(--v-info-lighten2) !important;
  caret-color: var(--v-info-lighten2) !important;
}
.v-application .info.lighten-1 {
  background-color: var(--v-info-lighten1) !important;
  border-color: var(--v-info-lighten1) !important;
}
.v-application .info--text.text--lighten-1 {
  color: var(--v-info-lighten1) !important;
  caret-color: var(--v-info-lighten1) !important;
}
.v-application .info.darken-1 {
  background-color: var(--v-info-darken1) !important;
  border-color: var(--v-info-darken1) !important;
}
.v-application .info--text.text--darken-1 {
  color: var(--v-info-darken1) !important;
  caret-color: var(--v-info-darken1) !important;
}
.v-application .info.darken-2 {
  background-color: var(--v-info-darken2) !important;
  border-color: var(--v-info-darken2) !important;
}
.v-application .info--text.text--darken-2 {
  color: var(--v-info-darken2) !important;
  caret-color: var(--v-info-darken2) !important;
}
.v-application .info.darken-3 {
  background-color: var(--v-info-darken3) !important;
  border-color: var(--v-info-darken3) !important;
}
.v-application .info--text.text--darken-3 {
  color: var(--v-info-darken3) !important;
  caret-color: var(--v-info-darken3) !important;
}
.v-application .info.darken-4 {
  background-color: var(--v-info-darken4) !important;
  border-color: var(--v-info-darken4) !important;
}
.v-application .info--text.text--darken-4 {
  color: var(--v-info-darken4) !important;
  caret-color: var(--v-info-darken4) !important;
}
.v-application .success {
  background-color: var(--v-success-base) !important;
  border-color: var(--v-success-base) !important;
}
.v-application .success--text {
  color: var(--v-success-base) !important;
  caret-color: var(--v-success-base) !important;
}
.v-application .success.lighten-5 {
  background-color: var(--v-success-lighten5) !important;
  border-color: var(--v-success-lighten5) !important;
}
.v-application .success--text.text--lighten-5 {
  color: var(--v-success-lighten5) !important;
  caret-color: var(--v-success-lighten5) !important;
}
.v-application .success.lighten-4 {
  background-color: var(--v-success-lighten4) !important;
  border-color: var(--v-success-lighten4) !important;
}
.v-application .success--text.text--lighten-4 {
  color: var(--v-success-lighten4) !important;
  caret-color: var(--v-success-lighten4) !important;
}
.v-application .success.lighten-3 {
  background-color: var(--v-success-lighten3) !important;
  border-color: var(--v-success-lighten3) !important;
}
.v-application .success--text.text--lighten-3 {
  color: var(--v-success-lighten3) !important;
  caret-color: var(--v-success-lighten3) !important;
}
.v-application .success.lighten-2 {
  background-color: var(--v-success-lighten2) !important;
  border-color: var(--v-success-lighten2) !important;
}
.v-application .success--text.text--lighten-2 {
  color: var(--v-success-lighten2) !important;
  caret-color: var(--v-success-lighten2) !important;
}
.v-application .success.lighten-1 {
  background-color: var(--v-success-lighten1) !important;
  border-color: var(--v-success-lighten1) !important;
}
.v-application .success--text.text--lighten-1 {
  color: var(--v-success-lighten1) !important;
  caret-color: var(--v-success-lighten1) !important;
}
.v-application .success.darken-1 {
  background-color: var(--v-success-darken1) !important;
  border-color: var(--v-success-darken1) !important;
}
.v-application .success--text.text--darken-1 {
  color: var(--v-success-darken1) !important;
  caret-color: var(--v-success-darken1) !important;
}
.v-application .success.darken-2 {
  background-color: var(--v-success-darken2) !important;
  border-color: var(--v-success-darken2) !important;
}
.v-application .success--text.text--darken-2 {
  color: var(--v-success-darken2) !important;
  caret-color: var(--v-success-darken2) !important;
}
.v-application .success.darken-3 {
  background-color: var(--v-success-darken3) !important;
  border-color: var(--v-success-darken3) !important;
}
.v-application .success--text.text--darken-3 {
  color: var(--v-success-darken3) !important;
  caret-color: var(--v-success-darken3) !important;
}
.v-application .success.darken-4 {
  background-color: var(--v-success-darken4) !important;
  border-color: var(--v-success-darken4) !important;
}
.v-application .success--text.text--darken-4 {
  color: var(--v-success-darken4) !important;
  caret-color: var(--v-success-darken4) !important;
}
.v-application .warning {
  background-color: var(--v-warning-base) !important;
  border-color: var(--v-warning-base) !important;
}
.v-application .warning--text {
  color: var(--v-warning-base) !important;
  caret-color: var(--v-warning-base) !important;
}
.v-application .warning.lighten-5 {
  background-color: var(--v-warning-lighten5) !important;
  border-color: var(--v-warning-lighten5) !important;
}
.v-application .warning--text.text--lighten-5 {
  color: var(--v-warning-lighten5) !important;
  caret-color: var(--v-warning-lighten5) !important;
}
.v-application .warning.lighten-4 {
  background-color: var(--v-warning-lighten4) !important;
  border-color: var(--v-warning-lighten4) !important;
}
.v-application .warning--text.text--lighten-4 {
  color: var(--v-warning-lighten4) !important;
  caret-color: var(--v-warning-lighten4) !important;
}
.v-application .warning.lighten-3 {
  background-color: var(--v-warning-lighten3) !important;
  border-color: var(--v-warning-lighten3) !important;
}
.v-application .warning--text.text--lighten-3 {
  color: var(--v-warning-lighten3) !important;
  caret-color: var(--v-warning-lighten3) !important;
}
.v-application .warning.lighten-2 {
  background-color: var(--v-warning-lighten2) !important;
  border-color: var(--v-warning-lighten2) !important;
}
.v-application .warning--text.text--lighten-2 {
  color: var(--v-warning-lighten2) !important;
  caret-color: var(--v-warning-lighten2) !important;
}
.v-application .warning.lighten-1 {
  background-color: var(--v-warning-lighten1) !important;
  border-color: var(--v-warning-lighten1) !important;
}
.v-application .warning--text.text--lighten-1 {
  color: var(--v-warning-lighten1) !important;
  caret-color: var(--v-warning-lighten1) !important;
}
.v-application .warning.darken-1 {
  background-color: var(--v-warning-darken1) !important;
  border-color: var(--v-warning-darken1) !important;
}
.v-application .warning--text.text--darken-1 {
  color: var(--v-warning-darken1) !important;
  caret-color: var(--v-warning-darken1) !important;
}
.v-application .warning.darken-2 {
  background-color: var(--v-warning-darken2) !important;
  border-color: var(--v-warning-darken2) !important;
}
.v-application .warning--text.text--darken-2 {
  color: var(--v-warning-darken2) !important;
  caret-color: var(--v-warning-darken2) !important;
}
.v-application .warning.darken-3 {
  background-color: var(--v-warning-darken3) !important;
  border-color: var(--v-warning-darken3) !important;
}
.v-application .warning--text.text--darken-3 {
  color: var(--v-warning-darken3) !important;
  caret-color: var(--v-warning-darken3) !important;
}
.v-application .warning.darken-4 {
  background-color: var(--v-warning-darken4) !important;
  border-color: var(--v-warning-darken4) !important;
}
.v-application .warning--text.text--darken-4 {
  color: var(--v-warning-darken4) !important;
  caret-color: var(--v-warning-darken4) !important;
}
.v-application .text {
  background-color: var(--v-text-base) !important;
  border-color: var(--v-text-base) !important;
}
.v-application .text--text {
  color: var(--v-text-base) !important;
  caret-color: var(--v-text-base) !important;
}
.v-application .text.lighten-5 {
  background-color: var(--v-text-lighten5) !important;
  border-color: var(--v-text-lighten5) !important;
}
.v-application .text--text.text--lighten-5 {
  color: var(--v-text-lighten5) !important;
  caret-color: var(--v-text-lighten5) !important;
}
.v-application .text.lighten-4 {
  background-color: var(--v-text-lighten4) !important;
  border-color: var(--v-text-lighten4) !important;
}
.v-application .text--text.text--lighten-4 {
  color: var(--v-text-lighten4) !important;
  caret-color: var(--v-text-lighten4) !important;
}
.v-application .text.lighten-3 {
  background-color: var(--v-text-lighten3) !important;
  border-color: var(--v-text-lighten3) !important;
}
.v-application .text--text.text--lighten-3 {
  color: var(--v-text-lighten3) !important;
  caret-color: var(--v-text-lighten3) !important;
}
.v-application .text.lighten-2 {
  background-color: var(--v-text-lighten2) !important;
  border-color: var(--v-text-lighten2) !important;
}
.v-application .text--text.text--lighten-2 {
  color: var(--v-text-lighten2) !important;
  caret-color: var(--v-text-lighten2) !important;
}
.v-application .text.lighten-1 {
  background-color: var(--v-text-lighten1) !important;
  border-color: var(--v-text-lighten1) !important;
}
.v-application .text--text.text--lighten-1 {
  color: var(--v-text-lighten1) !important;
  caret-color: var(--v-text-lighten1) !important;
}
.v-application .text.darken-1 {
  background-color: var(--v-text-darken1) !important;
  border-color: var(--v-text-darken1) !important;
}
.v-application .text--text.text--darken-1 {
  color: var(--v-text-darken1) !important;
  caret-color: var(--v-text-darken1) !important;
}
.v-application .text.darken-2 {
  background-color: var(--v-text-darken2) !important;
  border-color: var(--v-text-darken2) !important;
}
.v-application .text--text.text--darken-2 {
  color: var(--v-text-darken2) !important;
  caret-color: var(--v-text-darken2) !important;
}
.v-application .text.darken-3 {
  background-color: var(--v-text-darken3) !important;
  border-color: var(--v-text-darken3) !important;
}
.v-application .text--text.text--darken-3 {
  color: var(--v-text-darken3) !important;
  caret-color: var(--v-text-darken3) !important;
}
.v-application .text.darken-4 {
  background-color: var(--v-text-darken4) !important;
  border-color: var(--v-text-darken4) !important;
}
.v-application .text--text.text--darken-4 {
  color: var(--v-text-darken4) !important;
  caret-color: var(--v-text-darken4) !important;
}
.v-application .background {
  background-color: var(--v-background-base) !important;
  border-color: var(--v-background-base) !important;
}
.v-application .background--text {
  color: var(--v-background-base) !important;
  caret-color: var(--v-background-base) !important;
}
.v-application .background.lighten-5 {
  background-color: var(--v-background-lighten5) !important;
  border-color: var(--v-background-lighten5) !important;
}
.v-application .background--text.text--lighten-5 {
  color: var(--v-background-lighten5) !important;
  caret-color: var(--v-background-lighten5) !important;
}
.v-application .background.lighten-4 {
  background-color: var(--v-background-lighten4) !important;
  border-color: var(--v-background-lighten4) !important;
}
.v-application .background--text.text--lighten-4 {
  color: var(--v-background-lighten4) !important;
  caret-color: var(--v-background-lighten4) !important;
}
.v-application .background.lighten-3 {
  background-color: var(--v-background-lighten3) !important;
  border-color: var(--v-background-lighten3) !important;
}
.v-application .background--text.text--lighten-3 {
  color: var(--v-background-lighten3) !important;
  caret-color: var(--v-background-lighten3) !important;
}
.v-application .background.lighten-2 {
  background-color: var(--v-background-lighten2) !important;
  border-color: var(--v-background-lighten2) !important;
}
.v-application .background--text.text--lighten-2 {
  color: var(--v-background-lighten2) !important;
  caret-color: var(--v-background-lighten2) !important;
}
.v-application .background.lighten-1 {
  background-color: var(--v-background-lighten1) !important;
  border-color: var(--v-background-lighten1) !important;
}
.v-application .background--text.text--lighten-1 {
  color: var(--v-background-lighten1) !important;
  caret-color: var(--v-background-lighten1) !important;
}
.v-application .background.darken-1 {
  background-color: var(--v-background-darken1) !important;
  border-color: var(--v-background-darken1) !important;
}
.v-application .background--text.text--darken-1 {
  color: var(--v-background-darken1) !important;
  caret-color: var(--v-background-darken1) !important;
}
.v-application .background.darken-2 {
  background-color: var(--v-background-darken2) !important;
  border-color: var(--v-background-darken2) !important;
}
.v-application .background--text.text--darken-2 {
  color: var(--v-background-darken2) !important;
  caret-color: var(--v-background-darken2) !important;
}
.v-application .background.darken-3 {
  background-color: var(--v-background-darken3) !important;
  border-color: var(--v-background-darken3) !important;
}
.v-application .background--text.text--darken-3 {
  color: var(--v-background-darken3) !important;
  caret-color: var(--v-background-darken3) !important;
}
.v-application .background.darken-4 {
  background-color: var(--v-background-darken4) !important;
  border-color: var(--v-background-darken4) !important;
}
.v-application .background--text.text--darken-4 {
  color: var(--v-background-darken4) !important;
  caret-color: var(--v-background-darken4) !important;
}</style><noscript data-vue-tag="ssr"><style>.g-image--loading{display:none;}</style></noscript>
  </head>
  <body >
    <div data-app="true" data-server-rendered="true" id="app" id="app" class="v-application v-application--is-ltr theme--dark"><div class="v-application--wrap"><header class="v-sheet v-sheet--tile theme--dark v-toolbar v-app-bar v-app-bar--elevate-on-scroll v-app-bar--fixed v-app-bar--hide-shadow primary" style="height:64px;margin-top:0px;transform:translateY(0px);left:0px;right:0px;"><div class="v-toolbar__content" style="height:64px;"><button type="button" class="primary v-btn v-btn--depressed theme--dark v-size--default"><span class="v-btn__content"><img src="/assets/img/logo.3bf5df7b.svg" class="svg" style="width:70px;height:30px;"></span></button><div class="spacer"></div><span class="v-tooltip v-tooltip--bottom"><!----><button type="button" class="primary v-btn v-btn--depressed v-btn--flat v-btn--icon v-btn--round theme--dark v-size--default"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate material-icons theme--dark">home</i></span></button></span><span class="v-tooltip v-tooltip--bottom"><!----><div class="v-menu"><button type="button" role="button" aria-haspopup="true" aria-expanded="false" class="primary v-btn v-btn--depressed v-btn--flat v-btn--icon v-btn--round theme--dark v-size--default"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate fas fa-newspaper theme--dark"></i></span></button><!----></div></span><span class="v-tooltip v-tooltip--bottom"><!----><div class="v-menu"><button type="button" role="button" aria-haspopup="true" aria-expanded="false" class="primary v-btn v-btn--depressed v-btn--flat v-btn--icon v-btn--round theme--dark v-size--default"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate far fa-lightbulb theme--dark"></i></span></button><!----></div></span><!----><!----><span class="v-tooltip v-tooltip--bottom"><!----><button type="button" class="primary v-btn v-btn--depressed v-btn--flat v-btn--icon v-btn--round theme--dark v-size--default"><span class="v-btn__content"><i aria-hidden="true" class="v-icon notranslate material-icons theme--dark">invert_colors</i></span></button></span></div></header><div class="container dark-container container--fluid color"><div class="container background"><div class="md-container"><h1 id="a-comprehensive-guide-for-scikit-learn-pipelines"><a href="#a-comprehensive-guide-for-scikit-learn-pipelines" aria-hidden="true"><span class="icon icon-link"></span></a>A Comprehensive Guide For scikit-learn Pipelines</h1>
<p>Scikit Learn has a very easy and useful architecture for building complete pipelines for machine learning. In this article, we'll go through a step by step example on how to used the different features and classes of this architecture.</p>
<hr>
<h2 id="why"><a href="#why" aria-hidden="true"><span class="icon icon-link"></span></a>Why?</h2>
<p>There are plenty of reasons why you might want to use a pipeline for machine learning like:</p>
<ul>
<li>Combine the preprocessing step with the inference step at one object.</li>
<li>Save the complete pipeline to disk.</li>
<li>Easily experiment with different techniques of preprocessing.</li>
<li>Pipeline reuse.</li>
<li>Easy cloud deployment.</li>
</ul>
<hr>
<h2 id="how"><a href="#how" aria-hidden="true"><span class="icon icon-link"></span></a>How?</h2>
<p>Alright, now let's get down to business. In this article we'll use a fairly easy and old problem as an example, which is the <a class="mdlink" href="https://www.kaggle.com/c/home-data-for-ml-course">Regression problem for predicting housing prices</a>.<br>
Download the data and you should have a <code>train.csv</code> file and a <code>test.csv</code> file, we'll load both using pandas.</p>
<hr>
<h3 id="loading-the-data"><a href="#loading-the-data" aria-hidden="true"><span class="icon icon-link"></span></a>Loading the data</h3>
<pre class="language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

train_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"train.csv"</span><span class="token punctuation">)</span>
test_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"test.csv"</span><span class="token punctuation">)</span>

<span class="token comment">## let's create a validation set from the training set</span>

msk <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>train_df<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.8</span>

val_df <span class="token operator">=</span> train_df<span class="token punctuation">[</span><span class="token operator">~</span>msk<span class="token punctuation">]</span>

train_df <span class="token operator">=</span> train_df<span class="token punctuation">[</span>msk<span class="token punctuation">]</span></code></pre>
<hr>
<h3 id="feature-selection"><a href="#feature-selection" aria-hidden="true"><span class="icon icon-link"></span></a>Feature selection</h3>
<p>This data has 163 columns, however, we are not going to use all of them.<br>
After doing a bit of EDA we choose a set of nominal, ordinal and numerical columns to work with.</p>
<pre class="language-python"><code class="language-python">nominal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"MSZoning"</span><span class="token punctuation">,</span> <span class="token string">"LotShape"</span><span class="token punctuation">,</span> <span class="token string">"LandContour"</span><span class="token punctuation">,</span> <span class="token string">"LotConfig"</span><span class="token punctuation">,</span> <span class="token string">"Neighborhood"</span><span class="token punctuation">,</span>
           <span class="token string">"Condition1"</span><span class="token punctuation">,</span> <span class="token string">"BldgType"</span><span class="token punctuation">,</span> <span class="token string">"RoofStyle"</span><span class="token punctuation">,</span>
           <span class="token string">"Foundation"</span><span class="token punctuation">,</span> <span class="token string">"CentralAir"</span><span class="token punctuation">,</span> <span class="token string">"SaleType"</span><span class="token punctuation">,</span> <span class="token string">"SaleCondition"</span><span class="token punctuation">]</span>

ordinal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"LandSlope"</span><span class="token punctuation">,</span> <span class="token string">"OverallQual"</span><span class="token punctuation">,</span> <span class="token string">"OverallCond"</span><span class="token punctuation">,</span> <span class="token string">"YearRemodAdd"</span><span class="token punctuation">,</span>
          <span class="token string">"ExterQual"</span><span class="token punctuation">,</span> <span class="token string">"ExterCond"</span><span class="token punctuation">,</span> <span class="token string">"BsmtQual"</span><span class="token punctuation">,</span> <span class="token string">"BsmtCond"</span><span class="token punctuation">,</span> <span class="token string">"BsmtExposure"</span><span class="token punctuation">,</span>
          <span class="token string">"KitchenQual"</span><span class="token punctuation">,</span> <span class="token string">"Functional"</span><span class="token punctuation">,</span> <span class="token string">"GarageCond"</span><span class="token punctuation">,</span> <span class="token string">"PavedDrive"</span><span class="token punctuation">]</span>

numerical <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"LotFrontage"</span><span class="token punctuation">,</span> <span class="token string">"LotArea"</span><span class="token punctuation">,</span> <span class="token string">"MasVnrArea"</span><span class="token punctuation">,</span> <span class="token string">"BsmtFinSF1"</span><span class="token punctuation">,</span> <span class="token string">"BsmtUnfSF"</span><span class="token punctuation">,</span>
            <span class="token string">"TotalBsmtSF"</span><span class="token punctuation">,</span> <span class="token string">"1stFlrSF"</span><span class="token punctuation">,</span> <span class="token string">"2ndFlrSF"</span><span class="token punctuation">,</span> <span class="token string">"GrLivArea"</span><span class="token punctuation">,</span> <span class="token string">"GarageArea"</span><span class="token punctuation">,</span>
            <span class="token string">"OpenPorchSF"</span><span class="token punctuation">]</span>

train_features <span class="token operator">=</span> train_df<span class="token punctuation">[</span>nominal <span class="token operator">+</span> ordinal <span class="token operator">+</span> numerical<span class="token punctuation">]</span>
train_label <span class="token operator">=</span> train_df<span class="token punctuation">[</span><span class="token string">"SalePrice"</span><span class="token punctuation">]</span>

val_features <span class="token operator">=</span> val_df<span class="token punctuation">[</span>nominal <span class="token operator">+</span> ordinal <span class="token operator">+</span> numerical<span class="token punctuation">]</span>
val_label <span class="token operator">=</span> val_df<span class="token punctuation">[</span><span class="token string">"SalePrice"</span><span class="token punctuation">]</span>

test_features <span class="token operator">=</span> test_df<span class="token punctuation">[</span>nominal <span class="token operator">+</span> ordinal <span class="token operator">+</span> numerical<span class="token punctuation">]</span></code></pre>
<p>If you want to see the entire selection process and EDA fully explained, you can see the notebook <a class="mdlink" href="https://www.kaggle.com/mahmoud1youssef/housing-prices-full-solution">here</a>  </p>
<hr>
<h3 id="preprocessing"><a href="#preprocessing" aria-hidden="true"><span class="icon icon-link"></span></a>Preprocessing</h3>
<p>Now let's choose a preprocessing plan, a very straight forward one is the following:</p>
<ul>
<li>
<p>Ordinal features</p>
<ul>
<li>Impute missing data with most frequent value</li>
<li>Use Ordinal Encoding</li>
</ul>
</li>
<li>
<p>Nominal Features</p>
<ul>
<li>Impute missing data with most frequent value</li>
<li>Use One Hot Encoding</li>
</ul>
</li>
<li>
<p>Numerical Features</p>
<ul>
<li>Impute missing data with mean value</li>
<li>Use Standard Scaling</li>
</ul>
</li>
</ul>
<p>As you may see, each family of features has its own unique way of getting processed. Let's create a Pipeline for each family.<br>
We can do so by using the <a class="mdlink" href="https://scikit-learn.org/stable/modules/generated/sklearn.pipeline.Pipeline.html">sklearn.pipeline.Pipeline</a> Object</p>
<pre class="language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>pipeline <span class="token keyword">import</span> Pipeline
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>impute <span class="token keyword">import</span> SimpleImputer
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler<span class="token punctuation">,</span> OrdinalEncoder<span class="token punctuation">,</span> OneHotEncoder

ordinal_pipeline <span class="token operator">=</span> Pipeline<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">(</span><span class="token string">"imputer"</span><span class="token punctuation">,</span> SimpleImputer<span class="token punctuation">(</span>strategy<span class="token operator">=</span><span class="token string">"most_frequent"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token string">"encoder"</span><span class="token punctuation">,</span> OrdinalEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

nominal_pipeline <span class="token operator">=</span> Pipeline<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">(</span><span class="token string">"imputer"</span><span class="token punctuation">,</span> SimpleImputer<span class="token punctuation">(</span>strategy<span class="token operator">=</span><span class="token string">"most_frequent"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token string">"encoder"</span><span class="token punctuation">,</span> OneHotEncoder<span class="token punctuation">(</span>sparse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> handle_unknown<span class="token operator">=</span><span class="token string">"ignore"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

numerical_pipeline <span class="token operator">=</span> Pipeline<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">(</span><span class="token string">"imputer"</span><span class="token punctuation">,</span> SimpleImputer<span class="token punctuation">(</span>strategy<span class="token operator">=</span><span class="token string">"mean"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token string">"scaler"</span><span class="token punctuation">,</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre>
<p>Now let's join all of the above in one pipeline that targets each column with its family's pipeline.<br>
We can do so using the <a class="mdlink" href="https://scikit-learn.org/stable/modules/generated/sklearn.compose.ColumnTransformer.html?highlight=columntransformer#sklearn.compose.ColumnTransformer">sklearn.compose.ColumnTransformer</a> Object</p>
<pre class="language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>compose <span class="token keyword">import</span> ColumnTransformer

<span class="token comment"># here we are going to instantiate a ColumnTransformer object with a list of tuples</span>
<span class="token comment"># each of which has a the name of the preprocessor</span>
<span class="token comment"># the transformation pipeline (could be a transformer)</span>
<span class="token comment"># and the list of column names we wish to transform</span>

preprocessing_pipeline <span class="token operator">=</span> ColumnTransformer<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">(</span><span class="token string">"nominal_preprocessor"</span><span class="token punctuation">,</span> nominal_pipeline<span class="token punctuation">,</span> nominal<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token string">"ordinal_preprocessor"</span><span class="token punctuation">,</span> ordinal_pipeline<span class="token punctuation">,</span> ordinal<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token string">"numerical_preprocessor"</span><span class="token punctuation">,</span> numerical_pipeline<span class="token punctuation">,</span> numerical<span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">## If you want to test this pipeline run the following code</span>

<span class="token comment"># preprocessed_features = preprocessing_pipeline.fit_transform(train_features)</span></code></pre>
<hr>
<h3 id="adding-the-model-to-the-pipeline"><a href="#adding-the-model-to-the-pipeline" aria-hidden="true"><span class="icon icon-link"></span></a>Adding the model to the pipeline</h3>
<p>Now that we're done creating the preprocessing pipeline let's add the model to the end.</p>
<pre class="language-python"><code class="language-python"><span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression

complete_pipeline <span class="token operator">=</span> Pipeline<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">(</span><span class="token string">"preprocessor"</span><span class="token punctuation">,</span> preprocessing_pipeline<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token string">"estimator"</span><span class="token punctuation">,</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span></code></pre>
<p>If you're waiting for the rest of the code, I'd like to tell you that that's it. Pretty easy isn't it. If the scikit-learn maintainers ask to take my heart I'd give it to them for such great API.<br>
The training and evaluation process is the same as any normal model</p>
<pre class="language-python"><code class="language-python">complete_pipeline<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_features<span class="token punctuation">,</span> train_label<span class="token punctuation">)</span>
score <span class="token operator">=</span> complete_pipeline<span class="token punctuation">.</span>score<span class="token punctuation">(</span>val_features<span class="token punctuation">,</span> val_label<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span>

predictions <span class="token operator">=</span> complete_pipeline<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_features<span class="token punctuation">)</span></code></pre>
<hr>
<h2 id="saving-and-loading-pipelines"><a href="#saving-and-loading-pipelines" aria-hidden="true"><span class="icon icon-link"></span></a>Saving and Loading Pipelines</h2>
<p>Now we want to save the entire preprocessing parameters and model parameters of this pipeline to disk and load it whenever needed.<br>
We are going to use <a href="https://joblib.readthedocs.io/en/latest/" class="mdlink">joblib</a> for this <strong>JOB</strong> ... get it? ... sorry.</p>
<h3 id="save-the-pipeline"><a href="#save-the-pipeline" aria-hidden="true"><span class="icon icon-link"></span></a>Save the pipeline</h3>
<p>We are going to save the model as a pickle (.pkl) file. The code is fairly simple.</p>
<pre class="language-python"><code class="language-python"><span class="token keyword">import</span> joblib

pipeline_filename <span class="token operator">=</span> <span class="token string">"my_pipeline.pkl"</span>
joblib<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>complete_pipeline<span class="token punctuation">,</span> pipeline_filename<span class="token punctuation">)</span></code></pre>
<hr>
<h3 id="load-the-pipeline"><a href="#load-the-pipeline" aria-hidden="true"><span class="icon icon-link"></span></a>Load the pipeline</h3>
<p>Now you're on your flask server and you wish to load the model to help a user predict the price of a house, so you want to load the model from disk when you start the server, or whenever a request is sent. That is also fairly simple.</p>
<pre class="language-python"><code class="language-python"><span class="token keyword">import</span> joblib

pipeline_filename <span class="token operator">=</span> <span class="token string">"path/to/pipeline/file.pkl"</span>

pipeline <span class="token operator">=</span> joblib<span class="token punctuation">.</span>load<span class="token punctuation">(</span>pipeline_filename<span class="token punctuation">)</span>

<span class="token comment">## do inference with pipeline.predict</span>
<span class="token comment"># ...</span></code></pre>
<hr>
<h2 id="full-code"><a href="#full-code" aria-hidden="true"><span class="icon icon-link"></span></a>Full Code</h2>
<pre class="language-python"><code class="language-python"><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np

train_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"train.csv"</span><span class="token punctuation">)</span>
test_df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">"test.csv"</span><span class="token punctuation">)</span>

<span class="token comment">## let's create a validation set from the training set</span>

msk <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>train_df<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">0.8</span>

val_df <span class="token operator">=</span> train_df<span class="token punctuation">[</span><span class="token operator">~</span>msk<span class="token punctuation">]</span>

train_df <span class="token operator">=</span> train_df<span class="token punctuation">[</span>msk<span class="token punctuation">]</span>


nominal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"MSZoning"</span><span class="token punctuation">,</span> <span class="token string">"LotShape"</span><span class="token punctuation">,</span> <span class="token string">"LandContour"</span><span class="token punctuation">,</span> <span class="token string">"LotConfig"</span><span class="token punctuation">,</span> <span class="token string">"Neighborhood"</span><span class="token punctuation">,</span>
           <span class="token string">"Condition1"</span><span class="token punctuation">,</span> <span class="token string">"BldgType"</span><span class="token punctuation">,</span> <span class="token string">"RoofStyle"</span><span class="token punctuation">,</span>
           <span class="token string">"Foundation"</span><span class="token punctuation">,</span> <span class="token string">"CentralAir"</span><span class="token punctuation">,</span> <span class="token string">"SaleType"</span><span class="token punctuation">,</span> <span class="token string">"SaleCondition"</span><span class="token punctuation">]</span>

ordinal <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"LandSlope"</span><span class="token punctuation">,</span> <span class="token string">"OverallQual"</span><span class="token punctuation">,</span> <span class="token string">"OverallCond"</span><span class="token punctuation">,</span> <span class="token string">"YearRemodAdd"</span><span class="token punctuation">,</span>
          <span class="token string">"ExterQual"</span><span class="token punctuation">,</span> <span class="token string">"ExterCond"</span><span class="token punctuation">,</span> <span class="token string">"BsmtQual"</span><span class="token punctuation">,</span> <span class="token string">"BsmtCond"</span><span class="token punctuation">,</span> <span class="token string">"BsmtExposure"</span><span class="token punctuation">,</span>
          <span class="token string">"KitchenQual"</span><span class="token punctuation">,</span> <span class="token string">"Functional"</span><span class="token punctuation">,</span> <span class="token string">"GarageCond"</span><span class="token punctuation">,</span> <span class="token string">"PavedDrive"</span><span class="token punctuation">]</span>

numerical <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"LotFrontage"</span><span class="token punctuation">,</span> <span class="token string">"LotArea"</span><span class="token punctuation">,</span> <span class="token string">"MasVnrArea"</span><span class="token punctuation">,</span> <span class="token string">"BsmtFinSF1"</span><span class="token punctuation">,</span> <span class="token string">"BsmtUnfSF"</span><span class="token punctuation">,</span>
            <span class="token string">"TotalBsmtSF"</span><span class="token punctuation">,</span> <span class="token string">"1stFlrSF"</span><span class="token punctuation">,</span> <span class="token string">"2ndFlrSF"</span><span class="token punctuation">,</span> <span class="token string">"GrLivArea"</span><span class="token punctuation">,</span> <span class="token string">"GarageArea"</span><span class="token punctuation">,</span>
            <span class="token string">"OpenPorchSF"</span><span class="token punctuation">]</span>

train_features <span class="token operator">=</span> train_df<span class="token punctuation">[</span>nominal <span class="token operator">+</span> ordinal <span class="token operator">+</span> numerical<span class="token punctuation">]</span>
train_label <span class="token operator">=</span> train_df<span class="token punctuation">[</span><span class="token string">"SalePrice"</span><span class="token punctuation">]</span>

val_features <span class="token operator">=</span> val_df<span class="token punctuation">[</span>nominal <span class="token operator">+</span> ordinal <span class="token operator">+</span> numerical<span class="token punctuation">]</span>
val_label <span class="token operator">=</span> val_df<span class="token punctuation">[</span><span class="token string">"SalePrice"</span><span class="token punctuation">]</span>

test_features <span class="token operator">=</span> test_df<span class="token punctuation">[</span>nominal <span class="token operator">+</span> ordinal <span class="token operator">+</span> numerical<span class="token punctuation">]</span>


<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>pipeline <span class="token keyword">import</span> Pipeline
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>impute <span class="token keyword">import</span> SimpleImputer
<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>preprocessing <span class="token keyword">import</span> StandardScaler<span class="token punctuation">,</span> OrdinalEncoder<span class="token punctuation">,</span> OneHotEncoder

ordinal_pipeline <span class="token operator">=</span> Pipeline<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">(</span><span class="token string">"imputer"</span><span class="token punctuation">,</span> SimpleImputer<span class="token punctuation">(</span>strategy<span class="token operator">=</span><span class="token string">"most_frequent"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token string">"encoder"</span><span class="token punctuation">,</span> OrdinalEncoder<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

nominal_pipeline <span class="token operator">=</span> Pipeline<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">(</span><span class="token string">"imputer"</span><span class="token punctuation">,</span> SimpleImputer<span class="token punctuation">(</span>strategy<span class="token operator">=</span><span class="token string">"most_frequent"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token string">"encoder"</span><span class="token punctuation">,</span> OneHotEncoder<span class="token punctuation">(</span>sparse<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> handle_unknown<span class="token operator">=</span><span class="token string">"ignore"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

numerical_pipeline <span class="token operator">=</span> Pipeline<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">(</span><span class="token string">"imputer"</span><span class="token punctuation">,</span> SimpleImputer<span class="token punctuation">(</span>strategy<span class="token operator">=</span><span class="token string">"mean"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token string">"scaler"</span><span class="token punctuation">,</span> StandardScaler<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>


<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>compose <span class="token keyword">import</span> ColumnTransformer

<span class="token comment"># here we are going to instantiate a ColumnTransformer object with a list of tuples</span>
<span class="token comment"># each of which has a the name of the preprocessor</span>
<span class="token comment"># the transformation pipeline (could be a transformer)</span>
<span class="token comment"># and the list of column names we wish to transform</span>

preprocessing_pipeline <span class="token operator">=</span> ColumnTransformer<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">(</span><span class="token string">"nominal_preprocessor"</span><span class="token punctuation">,</span> nominal_pipeline<span class="token punctuation">,</span> nominal<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token string">"ordinal_preprocessor"</span><span class="token punctuation">,</span> ordinal_pipeline<span class="token punctuation">,</span> ordinal<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token string">"numerical_preprocessor"</span><span class="token punctuation">,</span> numerical_pipeline<span class="token punctuation">,</span> numerical<span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>

<span class="token comment">## If you want to test this pipeline run the following code</span>

<span class="token comment"># preprocessed_features = preprocessing_pipeline.fit_transform(train_features)</span>


<span class="token keyword">from</span> sklearn<span class="token punctuation">.</span>linear_model <span class="token keyword">import</span> LinearRegression

complete_pipeline <span class="token operator">=</span> Pipeline<span class="token punctuation">(</span><span class="token punctuation">[</span>
    <span class="token punctuation">(</span><span class="token string">"preprocessor"</span><span class="token punctuation">,</span> preprocessing_pipeline<span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token string">"estimator"</span><span class="token punctuation">,</span> LinearRegression<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span>


complete_pipeline<span class="token punctuation">.</span>fit<span class="token punctuation">(</span>train_features<span class="token punctuation">,</span> train_label<span class="token punctuation">)</span>
score <span class="token operator">=</span> complete_pipeline<span class="token punctuation">.</span>score<span class="token punctuation">(</span>val_features<span class="token punctuation">,</span> val_label<span class="token punctuation">)</span>

<span class="token keyword">print</span><span class="token punctuation">(</span>score<span class="token punctuation">)</span>

predictions <span class="token operator">=</span> complete_pipeline<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_features<span class="token punctuation">)</span>


<span class="token keyword">import</span> joblib

pipeline_filename <span class="token operator">=</span> <span class="token string">"my_pipeline.pkl"</span>
joblib<span class="token punctuation">.</span>dump<span class="token punctuation">(</span>complete_pipeline<span class="token punctuation">,</span> pipeline_filename<span class="token punctuation">)</span>


pipeline <span class="token operator">=</span> joblib<span class="token punctuation">.</span>load<span class="token punctuation">(</span>pipeline_filename<span class="token punctuation">)</span>

predictions <span class="token operator">=</span> pipeline<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>test_df<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>predictions<span class="token punctuation">)</span></code></pre>
<hr>
<p>That's it, Congratulations, you've just created, saved and loaded your complete pipeline.<br>
I hope this article was helpful, if not, please tell me how to improve it, I would really appreciate that.
Thank you.</p>
<hr>
<p><a class="mdlink" href="https://www.oreilly.com/library/view/hands-on-machine-learning/9781492032632/">Reference Book</a></p>
<p><a class="mdlink" href="https://www.kaggle.com/mahmoud1youssef/housing-prices-full-solution">My Notebook</a></p>
</div></div></div><footer class="v-footer primary footer v-sheet v-sheet--tile theme--dark v-footer--fixed v-footer--padless" style="left:0px;right:0px;bottom:0px;"><div class="container"><div class="row"><div class="col-sm-4 col-12"><div role="list" class="v-list primary v-sheet v-sheet--tile theme--dark v-list--dense v-list--flat"><div class="v-subheader theme--dark">Social media</div><div role="listbox" class="v-item-group theme--dark v-list-item-group text--text"><a tabindex="0" href="https://www.linkedin.com/in/mahmoud-yusof-a39ab5151/" target="_blank" role="listitem" aria-selected="false" class="v-list-item v-list-item--link theme--dark"><div class="v-list-item__icon"><i aria-hidden="true" class="v-icon notranslate fab fa-linkedin theme--dark"></i></div><div class="v-list-item__content"><div class="v-list-item__title">I share achievements</div></div></a><a tabindex="0" href="https://twitter.com/mahmoudyusof" target="_blank" role="listitem" aria-selected="false" class="v-list-item v-list-item--link theme--dark"><div class="v-list-item__icon"><i aria-hidden="true" class="v-icon notranslate fab fa-twitter theme--dark"></i></div><div class="v-list-item__content"><div class="v-list-item__title">I share articles</div></div></a><a tabindex="0" href="https://www.facebook.com/mahmoud.youssef27/" target="_blank" role="listitem" aria-selected="false" class="v-list-item v-list-item--link theme--dark"><div class="v-list-item__icon"><i aria-hidden="true" class="v-icon notranslate fab fa-facebook theme--dark"></i></div><div class="v-list-item__content"><div class="v-list-item__title">I share memes</div></div></a></div></div></div><div class="col-sm-4 col-12"><div role="list" class="v-list primary v-sheet v-sheet--tile theme--dark v-list--dense v-list--flat"><div class="v-subheader theme--dark">Contact Information</div><div role="listbox" class="v-item-group theme--dark v-list-item-group text--text"><a tabindex="0" href="mailto:mahmoud.yusof27@gmail.com" role="listitem" aria-selected="false" class="v-list-item v-list-item--link theme--dark"><div class="v-list-item__icon"><i aria-hidden="true" class="v-icon notranslate material-icons theme--dark">mail_outline</i></div><div class="v-list-item__content"><div class="v-list-item__title">mahmoud.yusof27@gmail.com</div></div></a><div tabindex="0" role="listitem" aria-selected="false" class="v-list-item v-list-item--link theme--dark"><div class="v-list-item__icon"><i aria-hidden="true" class="v-icon notranslate fas fa-phone theme--dark"></i></div><div class="v-list-item__content"><div class="v-list-item__title">+20 111 601 0514</div></div></div></div></div></div><div class="col-sm-4 col-12"><div role="list" class="v-list primary v-sheet v-sheet--tile theme--dark v-list--dense v-list--flat"><div class="v-subheader theme--dark">Credits</div><div role="listbox" class="v-item-group theme--dark v-list-item-group text--text"><a tabindex="0" href="https://unsplash.com/@brenomachado" target="_blank" role="listitem" aria-selected="false" class="v-list-item v-list-item--link theme--dark"><div class="v-list-item__icon"><i aria-hidden="true" class="v-icon notranslate material-icons theme--dark">image</i></div><div class="v-list-item__content"><div class="v-list-item__title">@brenomachado</div></div></a><a tabindex="0" href="https://unsplash.com/@epicantus" target="_blank" role="listitem" aria-selected="false" class="v-list-item v-list-item--link theme--dark"><div class="v-list-item__icon"><i aria-hidden="true" class="v-icon notranslate material-icons theme--dark">image</i></div><div class="v-list-item__content"><div class="v-list-item__title">@epicantus</div></div></a></div></div></div></div><div class="row px-5"><p class="copy">
          Copy rights © 2020, Designed and created by Mahmoud Youssef
        </p></div></div></footer></div></div>
    <script src="/assets/js/app.640e4b72.js" defer></script><script src="/assets/js/page--src--templates--article-vue.e8a69820.js" defer></script>
  </body>
</html>
